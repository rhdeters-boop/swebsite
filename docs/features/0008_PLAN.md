# Feature 0008: Comprehensive User Support & Trust Center

## Overview
Build a complete user support and trust infrastructure by enhancing the existing Help Center, creating dynamic content pages for FAQs and policies, and implementing a full support ticket system with backend integration.

## Component 1: Help Center Enhancement

### Files to modify:
- `src/pages/HelpCenter.tsx` - Add live search and refactor for maintainability
- `src/data/helpContent.ts` (new) - Extract and structure help content data
- `src/components/help/HelpCategoryCard.tsx` (new) - Reusable category card component

### Data structure (`src/data/helpContent.ts`):
```typescript
interface HelpArticle {
  id: string;
  slug: string;
  title: string;
  category: string;
  content: string;
  keywords: string[];
  lastUpdated: Date;
}

interface HelpCategory {
  id: string;
  icon: React.ReactNode;
  title: string;
  description: string;
  articles: HelpArticle[];
}
```

### Search implementation:
- Case-insensitive search across category titles, article titles, and keywords
- Real-time filtering using React state
- Debounced search input (300ms) to improve performance

## Component 2: Dynamic Article Pages

### Files to create/modify:
- `src/pages/help/ArticlePage.tsx` (new) - Dynamic article template
- `src/App.tsx` - Add route `/help/:slug`
- `src/components/help/Breadcrumbs.tsx` (new) - Navigation breadcrumbs
- `src/data/legalContent.ts` (new) - Legal and safety content data

### Article content structure:
```typescript
interface ArticleContent {
  id: string;
  slug: string;
  title: string;
  category: string;
  content: string; // Markdown or HTML
  relatedArticles?: string[]; // IDs of related articles
  lastUpdated: Date;
}
```

### Initial articles to create:
- Getting Started: how-to-create-account, setting-up-profile, how-to-follow-creators
- For Creators: becoming-a-creator, uploading-content-standards, understanding-earnings, copyright-basics
- Account & Billing: accepted-payment-methods, manage-cancel-subscription, refund-policy, securing-account-2fa
- Technical Support: troubleshooting-video-playback, resolving-upload-problems, cant-log-in

## Component 3: Support Ticket System

### Backend - Database Schema

#### New model: `backend/models/SupportTicket.js`
```javascript
{
  id: UUID,
  userId: UUID (foreign key),
  email: String,
  subject: String,
  description: Text,
  category: Enum(['billing', 'technical', 'account', 'general']),
  status: Enum(['open', 'in_progress', 'closed']),
  priority: Enum(['low', 'medium', 'high']),
  ticketNumber: String (unique, auto-generated),
  createdAt: Date,
  updatedAt: Date,
  closedAt: Date (nullable)
}
```

#### New model: `backend/models/TicketResponse.js`
```javascript
{
  id: UUID,
  ticketId: UUID (foreign key),
  userId: UUID (foreign key, admin/support staff),
  message: Text,
  isInternal: Boolean,
  createdAt: Date
}
```

### Backend - API Endpoints

#### New routes: `backend/routes/support.js`
- `POST /api/support/tickets` - Create new ticket (authenticated)
- `GET /api/support/tickets` - List user's tickets (authenticated)
- `GET /api/support/tickets/:ticketNumber` - Get ticket details (authenticated)
- `POST /api/support/tickets/:ticketNumber/messages` - Add message to ticket
- `PUT /api/support/tickets/:ticketNumber/status` - Update ticket status (admin)

### Frontend - Components

#### Files to create:
- `src/pages/support/SubmitTicket.tsx` (new) - Ticket submission form
- `src/pages/support/MyTickets.tsx` (new) - List user's tickets
- `src/pages/support/TicketDetail.tsx` (new) - View ticket conversation
- `src/hooks/useSupport.ts` (new) - Support ticket API hooks
- `src/services/supportService.ts` (new) - API service layer

### Email Integration
- Use existing email service to send confirmation emails
- Template: "Support Ticket Received - #{ticketNumber}"
- Include ticket details and expected response time

## Component 3.5: Admin Support Interface

### Backend - Admin Models & Permissions

#### Update User model to include support roles:
```javascript
{
  // existing fields...
  role: Enum(['user', 'creator', 'support_agent', 'support_admin', 'admin']),
  supportTeamId: UUID (nullable, foreign key)
}
```

#### New model: `backend/models/SupportTeam.js`
```javascript
{
  id: UUID,
  name: String,
  description: String,
  isActive: Boolean,
  createdAt: Date
}
```

#### New model: `backend/models/TicketAssignment.js`
```javascript
{
  id: UUID,
  ticketId: UUID (foreign key),
  assignedToId: UUID (foreign key to User),
  assignedById: UUID (foreign key to User),
  assignedAt: Date,
  unassignedAt: Date (nullable)
}
```

### Backend - Admin API Endpoints

#### Additional routes in `backend/routes/admin/support.js`:
- `GET /api/admin/support/tickets` - List all tickets with filters
  - Query params: status, category, priority, assignedTo, dateFrom, dateTo, search
  - Pagination: page, limit, sortBy, sortOrder
- `GET /api/admin/support/tickets/stats` - Dashboard statistics
- `PUT /api/admin/support/tickets/:ticketNumber/assign` - Assign ticket to agent
- `PUT /api/admin/support/tickets/:ticketNumber/priority` - Update priority
- `POST /api/admin/support/tickets/:ticketNumber/internal-note` - Add internal note
- `GET /api/admin/support/agents` - List support agents
- `GET /api/admin/support/export` - Export tickets data (CSV/JSON)

### Frontend - Admin Components

#### Files to create:
- `src/pages/admin/support/Dashboard.tsx` - Overview with stats and charts
- `src/pages/admin/support/TicketList.tsx` - Filterable ticket table
- `src/pages/admin/support/TicketManagement.tsx` - Detailed ticket view with actions
- `src/components/admin/support/TicketFilters.tsx` - Advanced filtering UI
- `src/components/admin/support/TicketStats.tsx` - Statistics cards
- `src/components/admin/support/AgentPerformance.tsx` - Agent metrics
- `src/hooks/useAdminSupport.ts` - Admin-specific support hooks

### Admin Dashboard Features:

#### 1. Overview Statistics:
- Total open tickets
- Average response time
- Tickets by category/priority
- Agent workload distribution
- Resolution rate trends

#### 2. Ticket Management Table:
```typescript
interface TicketTableColumns {
  ticketNumber: string;
  subject: string;
  user: { email: string; username: string };
  category: string;
  priority: 'low' | 'medium' | 'high';
  status: string;
  assignedTo?: { name: string; avatar: string };
  createdAt: Date;
  lastActivity: Date;
  responseTime?: number; // in hours
}
```

#### 3. Filtering & Sorting:
- Multi-select filters for status, category, priority
- Date range picker for creation/update dates
- Agent assignment filter
- Full-text search across ticket content
- Sort by: date, priority, response time, user

#### 4. Bulk Actions:
- Assign multiple tickets to agent
- Update status/priority for multiple tickets
- Export selected tickets

#### 5. Ticket Detail View:
- Full conversation thread
- User profile sidebar (subscription status, history)
- Quick actions: assign, change priority, add note
- Internal notes (hidden from user)
- Canned responses dropdown
- Related tickets suggestion

### Admin UI Design:
- Dark theme consistent with platform
- Color-coded priority indicators (red/yellow/green)
- Status badges with appropriate colors
- Agent avatars for quick identification
- Keyboard shortcuts for common actions (a=assign, r=reply, c=close)

### Performance Considerations:
- Implement ticket caching with Redis
- Paginate ticket lists (50 per page)
- Index database on common filter fields
- Real-time updates via WebSocket for assigned tickets
- Lazy load ticket messages for performance

## Component 4: Legal & Community Pages Enhancement

### Files to modify:
- `src/pages/TermsOfService.tsx` - Convert to use dynamic content
- `src/pages/PrivacyPolicy.tsx` - Convert to use dynamic content
- `src/pages/CommunityGuidelines.tsx` (new) - Community rules page
- `src/pages/SafetyCenter.tsx` (new) - Safety information page
- `src/pages/CopyrightPolicy.tsx` (new) - DMCA policy page

### Content structure:
All legal pages will use the ArticlePage template with content from `src/data/legalContent.ts`:
- Terms of Service (existing, refactor to use data)
- Privacy Policy (existing, refactor to use data)
- Copyright/DMCA Policy (new)
- Community Guidelines (new)
- Safety Center (new)

## Implementation Notes

### Search Algorithm:
```typescript
const searchArticles = (query: string, categories: HelpCategory[]) => {
  const normalizedQuery = query.toLowerCase();
  return categories.map(category => ({
    ...category,
    articles: category.articles.filter(article =>
      article.title.toLowerCase().includes(normalizedQuery) ||
      article.keywords.some(keyword => 
        keyword.toLowerCase().includes(normalizedQuery)
      )
    )
  })).filter(category => 
    category.title.toLowerCase().includes(normalizedQuery) ||
    category.articles.length > 0
  );
};
```

### Ticket Number Generation:
Format: `TKT-YYYYMMDD-XXXX` where XXXX is a sequential number for that day

### Email Service Integration:
Utilize existing email service configuration in backend for ticket confirmations

### UI Consistency:
- Follow existing Tailwind config with void theme colors
- Use existing card components and form styles
- Maintain dark theme with purple/pink accents
- Use existing navigation patterns (breadcrumbs similar to BreadcrumbNav component)

### Database Migrations:
1. Create SupportTicket table with all fields and indexes
2. Create TicketResponse table with foreign key relationships
3. Add support ticket associations to User model
4. Create indexes on ticketNumber and status for performance